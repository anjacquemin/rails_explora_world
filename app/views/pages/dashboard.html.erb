<div data-controller="maindashboard" class="dashboard-container ">
  <div class="sidebar">
    <div class="items my-5">
      <li data-action="click->maindashboard#openTab" data-tab="my-visits">MY VISITS</li>
      <li data-action="click->maindashboard#openTab" data-tab="my-map">MY MAP</li>
      <li data-action="click->maindashboard#openTab" data-tab="my-vod">MY VOD</li>
      <li data-action="click->maindashboard#openTab" data-tab="my-friends">MY FRIENDS</li>
      <li data-action="click->maindashboard#openTab" data-tab="my-leaderboard">LEADERBOARD</li>
    </div>
  </div>
  <div class="dashboard-content">
    <div class="mt-3 text-align-center">
      <h1 class=""><%= "DASHBOARD" %></h1>
      <% unless @last_rental.nil? %>
        <p class="text-success" ><%= "Last visit confirmed !" %></p>
        <p class="text-success"><%= "at : #{@last_rental.slot.start_at}" %></p>
        <p class="text-success"> <%= "With #{@last_rental.slot.user.first_name}" %></p>
      <% end %>
    </div>

    <div id="my-visits" data-controller="dashboard">
      <div>
        <button id="button3" class="btn-ghost mx-3 " data-action="click->dashboard#openTab" data-tab="future-visits">FUTURE VISITS</button>
        <button id="button4" class="btn-ghost mx-3 " data-action="click->dashboard#openTab" data-tab="past-visits">PAST VISITS</button>
      </div>
      <div id="future-visits">
        <div class="cards my-5">
          <% @rentals.each do |rental| %>
            <% if (rental.slot.start_at > Date.today) %>
              <div class="card-category mb-4">
                <%= cl_image_tag rental.slot.offer.photos.all[0].key, height: 250 %>
                <div class="text mt-3">
                  <h3 class="title"><%= rental.slot.offer.title %></h3>
                  <p><%= rental.slot.offer.description %></p>
                  <p><%= "Starts at: #{rental.slot.start_at}" %></p>
                </div>
                <div class="card-text">
                  <%= link_to "Go to the live visit !",  slot_path(rental.slot)%>                    </div>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>

      <div id="past-visits" class="d-none">
        <% @rentals.each do |rental| %>
          <% if (rental.slot.start_at < Date.today) %>
            <h2> <%=rental.slot.offer.title%> </h2>
            <p>Description : <%=rental.slot.offer.description%> </h2>
            <p>Start time : <%=rental.slot.start_at%> </h2>
          <% end %>
        <% end %>
      </div>
    </div>

    <div id="my-flashcards" class="d-none">
      MY FLASHCARDS
    </div>

    <div id="my-map" class="d-none">
      <div style="width: 100%; height: 600px;"
        data-controller="mapbox"
        data-mapbox-markers-value="<%= @markers.to_json %>"
        data-mapbox-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
    </div>
  </div>
  <div class="endbar">
    <div class="profile">
      <p>PROFILE BOARD</p>
    </div>
    <div class="picture">
      <p>PICTURE BOARD</p>
    </div>
  </div>
</div>
